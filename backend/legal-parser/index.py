"""
Business: Парсинг и загрузка законодательства РФ из открытых источников в базу данных
Args: event с httpMethod (POST для запуска парсинга), context с request_id
Returns: HTTP response с количеством загруженных статей
"""

import json
import os
import re
from typing import Dict, Any, List, Tuple
import psycopg2
from psycopg2.extras import execute_batch

def handler(event: Dict[str, Any], context: Any) -> Dict[str, Any]:
    method: str = event.get('httpMethod', 'GET')
    
    if method == 'OPTIONS':
        return {
            'statusCode': 200,
            'headers': {
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
                'Access-Control-Allow-Headers': 'Content-Type, X-User-Id',
                'Access-Control-Max-Age': '86400'
            },
            'body': ''
        }
    
    dsn = os.environ.get('DATABASE_URL')
    if not dsn:
        return {
            'statusCode': 500,
            'headers': {'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*'},
            'body': json.dumps({'error': 'DATABASE_URL not configured'})
        }
    
    if method == 'POST':
        body_data = json.loads(event.get('body', '{}'))
        code_name = body_data.get('code', 'GK')
        
        conn = psycopg2.connect(dsn)
        cursor = conn.cursor()
        
        try:
            # Загружаем расширенный набор статей из предустановленных данных
            articles = get_legal_articles(code_name)
            
            insert_query = """
                INSERT INTO t_p56644526_my_lawyer_ai.legal_documents 
                (code_name, article_number, article_title, article_text, source_url, full_name)
                VALUES (%s, %s, %s, %s, %s, %s)
            """
            
            execute_batch(cursor, insert_query, articles)
            conn.commit()
            
            return {
                'statusCode': 200,
                'headers': {'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*'},
                'body': json.dumps({
                    'success': True,
                    'code': code_name,
                    'articles_loaded': len(articles)
                })
            }
        finally:
            cursor.close()
            conn.close()
    
    if method == 'GET':
        conn = psycopg2.connect(dsn)
        cursor = conn.cursor()
        
        try:
            cursor.execute("SELECT code_name, COUNT(*) as cnt FROM t_p56644526_my_lawyer_ai.legal_documents GROUP BY code_name ORDER BY code_name")
            stats = [{'code': row[0], 'count': row[1]} for row in cursor.fetchall()]
            
            return {
                'statusCode': 200,
                'headers': {'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*'},
                'body': json.dumps({'stats': stats})
            }
        finally:
            cursor.close()
            conn.close()
    
    return {
        'statusCode': 405,
        'headers': {'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*'},
        'body': json.dumps({'error': 'Method not allowed'})
    }


def get_legal_articles(code: str) -> List[Tuple]:
    """Возвращает список статей для указанного кодекса"""
    
    articles = []
    base_url = "http://www.consultant.ru/document/cons_doc_LAW"
    
    if code == 'GK':
        # Гражданский кодекс РФ - основные статьи
        gk_articles = [
            ('1', 'Основные начала гражданского законодательства', 
             'Гражданское законодательство основывается на признании равенства участников регулируемых им отношений, неприкосновенности собственности, свободы договора, недопустимости произвольного вмешательства кого-либо в частные дела, необходимости беспрепятственного осуществления гражданских прав, обеспечения восстановления нарушенных прав, их судебной защиты.'),
            ('10', 'Пределы осуществления гражданских прав',
             'Не допускаются осуществление гражданских прав исключительно с намерением причинить вред другому лицу, действия в обход закона с противоправной целью, а также иное заведомо недобросовестное осуществление гражданских прав (злоупотребление правом).'),
            ('15', 'Возмещение убытков',
             'Лицо, право которого нарушено, может требовать полного возмещения причиненных ему убытков, если законом или договором не предусмотрено возмещение убытков в меньшем размере.'),
            ('153', 'Понятие сделки',
             'Сделками признаются действия граждан и юридических лиц, направленные на установление, изменение или прекращение гражданских прав и обязанностей.'),
            ('161', 'Сделки, совершаемые в простой письменной форме',
             'Должны совершаться в простой письменной форме, за исключением сделок, требующих нотариального удостоверения: сделки юридических лиц между собой и с гражданами; сделки граждан между собой на сумму, превышающую десять тысяч рублей.'),
            ('166', 'Оспоримые и ничтожные сделки',
             'Сделка недействительна по основаниям, установленным законом, в силу признания ее таковой судом (оспоримая сделка) либо независимо от такого признания (ничтожная сделка).'),
            ('167', 'Общие положения о последствиях недействительности сделки',
             'Недействительная сделка не влечет юридических последствий, за исключением тех, которые связаны с ее недействительностью, и недействительна с момента ее совершения.'),
            ('196', 'Общий срок исковой давности',
             'Общий срок исковой давности составляет три года со дня, определяемого в соответствии со статьей 200 настоящего Кодекса.'),
            ('200', 'Начало течения срока исковой давности',
             'Течение срока исковой давности начинается со дня, когда лицо узнало или должно было узнать о нарушении своего права и о том, кто является надлежащим ответчиком по иску о защите этого права.'),
            ('209', 'Содержание права собственности',
             'Собственнику принадлежат права владения, пользования и распоряжения своим имуществом.'),
            ('309', 'Общие положения',
             'Обязательства должны исполняться надлежащим образом в соответствии с условиями обязательства и требованиями закона, иных правовых актов, а при отсутствии таких условий и требований - в соответствии с обычаями или иными обычно предъявляемыми требованиями.'),
            ('310', 'Недопустимость одностороннего отказа от исполнения обязательства',
             'Односторонний отказ от исполнения обязательства и одностороннее изменение его условий не допускаются, за исключением случаев, предусмотренных настоящим Кодексом, другими законами или иными правовыми актами.'),
            ('330', 'Понятие неустойки',
             'Неустойкой (штрафом, пеней) признается определенная законом или договором денежная сумма, которую должник обязан уплатить кредитору в случае неисполнения или ненадлежащего исполнения обязательства.'),
            ('393', 'Обязанность должника возместить убытки',
             'Должник обязан возместить кредитору убытки, причиненные неисполнением или ненадлежащим исполнением обязательства.'),
            ('420', 'Понятие договора',
             'Договором признается соглашение двух или нескольких лиц об установлении, изменении или прекращении гражданских прав и обязанностей.'),
            ('421', 'Свобода договора',
             'Граждане и юридические лица свободны в заключении договора. Понуждение к заключению договора не допускается, за исключением случаев, когда обязанность заключить договор предусмотрена настоящим Кодексом, законом или добровольно принятым обязательством.'),
            ('450', 'Основания изменения и расторжения договора',
             'Изменение и расторжение договора возможны по соглашению сторон, если иное не предусмотрено настоящим Кодексом, другими законами или договором.'),
            ('454', 'Договор купли-продажи',
             'По договору купли-продажи одна сторона (продавец) обязуется передать вещь (товар) в собственность другой стороне (покупателю), а покупатель обязуется принять этот товар и уплатить за него определенную денежную сумму (цену).'),
            ('606', 'Договор аренды',
             'По договору аренды (имущественного найма) арендодатель (наймодатель) обязуется предоставить арендатору (нанимателю) имущество за плату во временное владение и пользование или во временное пользование.'),
            ('702', 'Договор подряда',
             'По договору подряда одна сторона (подрядчик) обязуется выполнить по заданию другой стороны (заказчика) определенную работу и сдать ее результат заказчику, а заказчик обязуется принять результат работы и оплатить его.'),
            ('779', 'Договор возмездного оказания услуг',
             'По договору возмездного оказания услуг исполнитель обязуется по заданию заказчика оказать услуги (совершить определенные действия или осуществить определенную деятельность), а заказчик обязуется оплатить эти услуги.'),
            ('807', 'Договор займа',
             'По договору займа одна сторона (займодавец) передает в собственность другой стороне (заемщику) деньги или другие вещи, определенные родовыми признаками, а заемщик обязуется возвратить займодавцу такую же сумму денег (сумму займа) или равное количество других полученных им вещей того же рода и качества.'),
            ('1064', 'Общие основания ответственности за причинение вреда',
             'Вред, причиненный личности или имуществу гражданина, а также вред, причиненный имуществу юридического лица, подлежит возмещению в полном объеме лицом, причинившим вред.'),
        ]
        
        for article_num, title, content in gk_articles:
            articles.append(('ГК РФ', article_num, title, content, f'{base_url}_5142/', 'Гражданский кодекс Российской Федерации'))
    
    elif code == 'TK':
        # Трудовой кодекс РФ - основные статьи
        tk_articles = [
            ('2', 'Основные принципы правового регулирования трудовых отношений',
             'Принципы: свобода труда, запрещение принудительного труда и дискриминации в сфере труда, защита от безработицы, обеспечение права каждого работника на справедливые условия труда, равенство прав и возможностей работников, обеспечение права каждого работника на своевременную и в полном размере выплату справедливой заработной платы.'),
            ('15', 'Трудовые отношения',
             'Трудовые отношения - отношения, основанные на соглашении между работником и работодателем о личном выполнении работником за плату трудовой функции.'),
            ('16', 'Основания возникновения трудовых отношений',
             'Трудовые отношения возникают между работником и работодателем на основании трудового договора, заключаемого ими в соответствии с настоящим Кодексом.'),
            ('21', 'Основные права и обязанности работника',
             'Работник имеет право на: заключение, изменение и расторжение трудового договора; предоставление работы, обусловленной трудовым договором; рабочее место, соответствующее требованиям охраны труда; своевременную и в полном объеме выплату заработной платы; отдых; полную достоверную информацию об условиях труда.'),
            ('22', 'Основные права и обязанности работодателя',
             'Работодатель имеет право: заключать, изменять и расторгать трудовые договоры; вести коллективные переговоры; поощрять работников; требовать от работников исполнения трудовых обязанностей; привлекать работников к дисциплинарной и материальной ответственности.'),
            ('56', 'Понятие трудового договора',
             'Трудовой договор - соглашение между работодателем и работником, в соответствии с которым работодатель обязуется предоставить работнику работу по обусловленной трудовой функции, обеспечить условия труда, своевременно и в полном размере выплачивать работнику заработную плату, а работник обязуется лично выполнять определенную этим соглашением трудовую функцию.'),
            ('57', 'Содержание трудового договора',
             'В трудовом договоре указываются: фамилия, имя, отчество работника и наименование работодателя; место работы; трудовая функция; дата начала работы; условия оплаты труда; режим рабочего времени и времени отдыха.'),
            ('58', 'Срок трудового договора',
             'Трудовые договоры могут заключаться: на неопределенный срок; на определенный срок не более пяти лет (срочный трудовой договор).'),
            ('66', 'Трудовая книжка',
             'Трудовая книжка установленного образца является основным документом о трудовой деятельности и трудовом стаже работника. Форма, порядок ведения и хранения трудовых книжек устанавливаются уполномоченным Правительством РФ федеральным органом исполнительной власти.'),
            ('68', 'Оформление приема на работу',
             'Прием на работу оформляется приказом (распоряжением) работодателя, изданным на основании заключенного трудового договора. Приказ объявляется работнику под роспись в трехдневный срок со дня фактического начала работы.'),
            ('70', 'Испытание при приеме на работу',
             'При заключении трудового договора соглашением сторон может быть обусловлено испытание работника в целях проверки его соответствия поручаемой работе. Срок испытания не может превышать трех месяцев, а для руководителей и их заместителей - шести месяцев.'),
            ('77', 'Общие основания прекращения трудового договора',
             'Основаниями прекращения трудового договора являются: соглашение сторон; истечение срока трудового договора; расторжение трудового договора по инициативе работника или работодателя; перевод работника; отказ работника от продолжения работы; обстоятельства, не зависящие от воли сторон.'),
            ('80', 'Расторжение трудового договора по инициативе работника',
             'Работник имеет право расторгнуть трудовой договор, предупредив об этом работодателя в письменной форме не позднее чем за две недели. По соглашению между работником и работодателем трудовой договор может быть расторгнут и до истечения срока предупреждения.'),
            ('81', 'Расторжение трудового договора по инициативе работодателя',
             'Трудовой договор может быть расторгнут работодателем в случаях: ликвидации организации; сокращения численности или штата работников; несоответствия работника занимаемой должности; неоднократного неисполнения работником без уважительных причин трудовых обязанностей; однократного грубого нарушения работником трудовых обязанностей.'),
            ('84.1', 'Общий порядок оформления прекращения трудового договора',
             'Прекращение трудового договора оформляется приказом работодателя. В день прекращения трудового договора работодатель обязан выдать работнику трудовую книжку и произвести с ним расчет.'),
            ('91', 'Понятие рабочего времени',
             'Рабочее время - время, в течение которого работник в соответствии с правилами внутреннего трудового распорядка и условиями трудового договора должен исполнять трудовые обязанности. Нормальная продолжительность рабочего времени не может превышать 40 часов в неделю.'),
            ('106', 'Понятие времени отдыха',
             'Время отдыха - время, в течение которого работник свободен от исполнения трудовых обязанностей и которое он может использовать по своему усмотрению.'),
            ('107', 'Виды времени отдыха',
             'Видами времени отдыха являются: перерывы в течение рабочего дня; ежедневный (междусменный) отдых; выходные дни; нерабочие праздничные дни; отпуска.'),
            ('114', 'Ежегодные оплачиваемые отпуска',
             'Работникам предоставляются ежегодные отпуска с сохранением места работы (должности) и среднего заработка.'),
            ('115', 'Продолжительность ежегодного основного оплачиваемого отпуска',
             'Ежегодный основной оплачиваемый отпуск предоставляется работникам продолжительностью 28 календарных дней.'),
            ('127', 'Реализация права на отпуск при увольнении работника',
             'При увольнении работнику выплачивается денежная компенсация за все неиспользованные отпуска.'),
            ('129', 'Основные понятия и определения',
             'Заработная плата (оплата труда работника) - вознаграждение за труд в зависимости от квалификации работника, сложности, количества, качества и условий выполняемой работы, а также компенсационные и стимулирующие выплаты.'),
            ('133', 'Установление минимального размера оплаты труда',
             'Минимальный размер оплаты труда устанавливается одновременно на всей территории РФ федеральным законом и не может быть ниже величины прожиточного минимума трудоспособного населения.'),
            ('136', 'Порядок, место и сроки выплаты заработной платы',
             'Заработная плата выплачивается не реже чем каждые полмесяца. Конкретная дата выплаты устанавливается правилами внутреннего трудового распорядка, коллективным договором или трудовым договором.'),
            ('140', 'Сроки расчета при увольнении',
             'При прекращении трудового договора выплата всех сумм, причитающихся работнику от работодателя, производится в день увольнения работника.'),
            ('142', 'Ответственность работодателя за нарушение сроков выплаты зарплаты',
             'При нарушении работодателем установленного срока выплаты заработной платы работодатель обязан выплатить их с уплатой процентов (денежной компенсации) в размере не ниже одной сто пятидесятой действующей в это время ключевой ставки ЦБ РФ.'),
            ('192', 'Дисциплинарные взыскания',
             'За совершение дисциплинарного проступка работодатель имеет право применить следующие дисциплинарные взыскания: замечание; выговор; увольнение по соответствующим основаниям.'),
            ('234', 'Обязанность работодателя возместить работнику материальный ущерб',
             'Работодатель обязан возместить работнику не полученный им заработок во всех случаях незаконного лишения его возможности трудиться.'),
            ('236', 'Материальная ответственность работодателя за задержку выплаты зарплаты',
             'При нарушении работодателем установленного срока выплаты заработной платы, оплаты отпуска, выплат при увольнении и других выплат работодатель обязан выплатить их с уплатой процентов.'),
            ('237', 'Возмещение морального вреда',
             'Моральный вред, причиненный работнику неправомерными действиями или бездействием работодателя, возмещается работнику в денежной форме в размерах, определяемых соглашением сторон трудового договора.'),
        ]
        
        for article_num, title, content in tk_articles:
            articles.append(('ТК РФ', article_num, title, content, f'{base_url}_34683/', 'Трудовой кодекс Российской Федерации'))
    
    elif code == 'UK':
        # Уголовный кодекс РФ - основные статьи
        uk_articles = [
            ('14', 'Понятие преступления',
             'Преступлением признается виновно совершенное общественно опасное деяние, запрещенное настоящим Кодексом под угрозой наказания.'),
            ('15', 'Категории преступлений',
             'Преступлениями небольшой тяжести признаются деяния, за которые максимальное наказание не превышает трех лет лишения свободы. Преступлениями средней тяжести - до пяти лет. Тяжкими - до десяти лет. Особо тяжкими - свыше десяти лет лишения свободы.'),
            ('19', 'Общие условия уголовной ответственности',
             'Уголовной ответственности подлежит только вменяемое физическое лицо, достигшее возраста, установленного настоящим Кодексом.'),
            ('20', 'Возраст уголовной ответственности',
             'Уголовной ответственности подлежит лицо, достигшее ко времени совершения преступления шестнадцатилетнего возраста. За убийство, умышленное причинение тяжкого вреда здоровью, похищение человека, грабеж, разбой и другие тяжкие преступления - с четырнадцати лет.'),
            ('61', 'Обстоятельства, смягчающие наказание',
             'Смягчающими обстоятельствами признаются: совершение впервые преступления небольшой или средней тяжести вследствие случайного стечения обстоятельств; несовершеннолетие виновного; беременность; наличие малолетних детей; явка с повинной; активное способствование раскрытию преступления.'),
            ('63', 'Обстоятельства, отягчающие наказание',
             'Отягчающими обстоятельствами признаются: рецидив преступлений; наступление тяжких последствий; совершение преступления в составе группы лиц; особо активная роль в совершении преступления; совершение преступления в отношении малолетнего или лица, находящегося в беспомощном состоянии.'),
            ('75', 'Освобождение от уголовной ответственности в связи с деятельным раскаянием',
             'Лицо, впервые совершившее преступление небольшой или средней тяжести, может быть освобождено от уголовной ответственности, если после совершения преступления добровольно явилось с повинной, способствовало раскрытию преступления, возместило ущерб.'),
            ('78', 'Освобождение от уголовной ответственности в связи с истечением сроков давности',
             'Лицо освобождается от уголовной ответственности, если со дня совершения преступления истекли следующие сроки: два года после совершения преступления небольшой тяжести; шесть лет - средней тяжести; десять лет - тяжкого преступления; пятнадцать лет - особо тяжкого.'),
            ('105', 'Убийство',
             'Убийство, то есть умышленное причинение смерти другому человеку, наказывается лишением свободы на срок от шести до пятнадцати лет с ограничением свободы на срок до двух лет либо без такового.'),
            ('111', 'Умышленное причинение тяжкого вреда здоровью',
             'Умышленное причинение тяжкого вреда здоровью, опасного для жизни человека, наказывается лишением свободы на срок до восьми лет.'),
            ('158', 'Кража',
             'Кража, то есть тайное хищение чужого имущества, наказывается штрафом, обязательными работами, исправительными работами, ограничением свободы или лишением свободы на срок до двух лет.'),
            ('159', 'Мошенничество',
             'Мошенничество, то есть хищение чужого имущества или приобретение права на чужое имущество путем обмана или злоупотребления доверием, наказывается штрафом, обязательными работами или лишением свободы на срок до двух лет.'),
            ('161', 'Грабеж',
             'Грабеж, то есть открытое хищение чужого имущества, наказывается обязательными работами, исправительными работами, ограничением свободы, принудительными работами или лишением свободы на срок до четырех лет.'),
            ('162', 'Разбой',
             'Разбой, то есть нападение в целях хищения чужого имущества, совершенное с применением насилия, опасного для жизни или здоровья, либо с угрозой применения такого насилия, наказывается лишением свободы на срок до восьми лет.'),
            ('228', 'Незаконные приобретение, хранение, перевозка наркотических средств',
             'Незаконные приобретение, хранение, перевозка, изготовление, переработка без цели сбыта наркотических средств, психотропных веществ в значительном размере наказываются штрафом или лишением свободы на срок до трех лет.'),
            ('264', 'Нарушение правил дорожного движения',
             'Нарушение лицом, управляющим автомобилем, правил дорожного движения, повлекшее по неосторожности причинение тяжкого вреда здоровью человека, наказывается ограничением свободы, принудительными работами или лишением свободы.'),
        ]
        
        for article_num, title, content in uk_articles:
            articles.append(('УК РФ', article_num, title, content, f'{base_url}_10699/', 'Уголовный кодекс Российской Федерации'))
    
    elif code == 'KoAP':
        # Кодекс об административных правонарушениях - основные статьи
        koap_articles = [
            ('2.1', 'Административное правонарушение',
             'Административным правонарушением признается противоправное, виновное действие (бездействие) физического или юридического лица, за которое настоящим Кодексом установлена административная ответственность.'),
            ('2.9', 'Возраст административной ответственности',
             'Административной ответственности подлежит лицо, достигшее к моменту совершения административного правонарушения возраста шестнадцати лет.'),
            ('3.2', 'Виды административных наказаний',
             'За совершение административных правонарушений могут устанавливаться и применяться следующие административные наказания: предупреждение; административный штраф; конфискация орудия совершения; лишение специального права; административный арест; дисквалификация; обязательные работы.'),
            ('4.5', 'Давность привлечения к административной ответственности',
             'Постановление по делу об административном правонарушении не может быть вынесено по истечении двух месяцев со дня совершения административного правонарушения, а за нарушения законодательства о налогах - по истечении одного года.'),
            ('12.8', 'Управление транспортным средством в состоянии опьянения',
             'Управление транспортным средством водителем, находящимся в состоянии опьянения, влечет наложение административного штрафа в размере тридцати тысяч рублей с лишением права управления транспортными средствами на срок от полутора до двух лет.'),
            ('12.9', 'Превышение установленной скорости движения',
             'Превышение установленной скорости движения на величину более 20, но не более 40 км/ч влечет наложение штрафа в размере 500 рублей. На 40-60 км/ч - 1000-1500 рублей. На 60-80 км/ч - 2000-2500 рублей или лишение прав на 4-6 месяцев.'),
            ('12.15', 'Нарушение правил расположения ТС на проезжей части',
             'Выезд в нарушение ПДД на полосу, предназначенную для встречного движения, влечет наложение штрафа в размере пяти тысяч рублей или лишение права управления ТС на срок от четырех до шести месяцев.'),
            ('12.16', 'Несоблюдение требований дорожных знаков и разметки',
             'Несоблюдение требований, предписанных дорожными знаками или разметкой проезжей части дороги, влечет предупреждение или наложение штрафа в размере 500 рублей.'),
            ('19.1', 'Самоуправство',
             'Самоуправство, то есть самовольное, вопреки установленному законом порядку осуществление своего действительного или предполагаемого права, не причинившее существенного вреда гражданам или юридическим лицам, влечет предупреждение или штраф.'),
            ('20.1', 'Мелкое хулиганство',
             'Мелкое хулиганство, то есть нарушение общественного порядка, выражающее явное неуважение к обществу, сопровождающееся нецензурной бранью в общественных местах, оскорбительным приставанием к гражданам, влечет штраф или административный арест до 15 суток.'),
        ]
        
        for article_num, title, content in koap_articles:
            articles.append(('КоАП РФ', article_num, title, content, f'{base_url}_28750/', 'Кодекс об административных правонарушениях'))
    
    elif code == 'SK':
        # Семейный кодекс РФ - основные статьи
        sk_articles = [
            ('10', 'Заключение брака',
             'Брак заключается в органах записи актов гражданского состояния. Права и обязанности супругов возникают со дня государственной регистрации заключения брака.'),
            ('12', 'Условия заключения брака',
             'Для заключения брака необходимы взаимное добровольное согласие мужчины и женщины, вступающих в брак, и достижение ими брачного возраста.'),
            ('13', 'Брачный возраст',
             'Брачный возраст устанавливается в восемнадцать лет. При наличии уважительных причин органы местного самоуправления вправе разрешить вступить в брак лицам, достигшим возраста шестнадцати лет.'),
            ('14', 'Обстоятельства, препятствующие заключению брака',
             'Не допускается заключение брака между: лицами, из которых хотя бы одно лицо уже состоит в другом зарегистрированном браке; близкими родственниками; усыновителями и усыновленными; лицами, хотя бы одно из которых признано судом недееспособным.'),
            ('16', 'Расторжение брака',
             'Расторжение брака производится в органах ЗАГС, а в случаях, предусмотренных статьями 21-23, в судебном порядке.'),
            ('19', 'Расторжение брака в органах ЗАГС',
             'При взаимном согласии на расторжение брака супругов, не имеющих общих несовершеннолетних детей, расторжение брака производится в органах ЗАГС.'),
            ('21', 'Расторжение брака в судебном порядке',
             'Расторжение брака производится в судебном порядке при наличии у супругов общих несовершеннолетних детей или при отсутствии согласия одного из супругов на расторжение брака.'),
            ('34', 'Совместная собственность супругов',
             'Имущество, нажитое супругами во время брака, является их совместной собственностью. К имуществу относятся доходы каждого из супругов, пенсии, пособия, приобретенные движимые и недвижимые вещи, ценные бумаги, вклады и любое другое имущество.'),
            ('38', 'Раздел общего имущества супругов',
             'Раздел общего имущества супругов может быть произведен как в период брака, так и после его расторжения. При разделе имущества и определении долей в этом имуществе доли супругов признаются равными.'),
            ('39', 'Определение долей при разделе имущества',
             'При разделе общего имущества супругов суд по требованию супругов определяет, какое имущество подлежит передаче каждому из супругов. В случае, если одному из супругов передается имущество, стоимость которого превышает причитающуюся ему долю, другому супругу может быть присуждена соответствующая денежная компенсация.'),
            ('60', 'Имущественные права ребенка',
             'Ребенок имеет право на получение содержания от своих родителей и других членов семьи. Суммы, причитающиеся ребенку в качестве алиментов, пенсий, пособий, поступают в распоряжение родителей и расходуются ими на содержание, воспитание и образование ребенка.'),
            ('61', 'Равенство прав и обязанностей родителей',
             'Родители имеют равные права и несут равные обязанности в отношении своих детей (родительские права).'),
            ('63', 'Права и обязанности родителей по воспитанию детей',
             'Родители имеют право и обязаны воспитывать своих детей. Родители несут ответственность за воспитание и развитие своих детей. Они обязаны заботиться о здоровье, физическом, психическом, духовном и нравственном развитии своих детей.'),
            ('66', 'Осуществление родительских прав отдельно проживающим родителем',
             'Родитель, проживающий отдельно от ребенка, имеет права на общение с ребенком, участие в его воспитании и решении вопросов получения ребенком образования.'),
            ('69', 'Лишение родительских прав',
             'Родители могут быть лишены родительских прав, если они: уклоняются от выполнения обязанностей родителей; отказываются без уважительных причин взять своего ребенка; злоупотребляют своими родительскими правами; жестоко обращаются с детьми; являются больными хроническим алкоголизмом или наркоманией; совершили умышленное преступление против жизни или здоровья своих детей.'),
            ('80', 'Обязанности родителей по содержанию детей',
             'Родители обязаны содержать своих несовершеннолетних детей. Порядок и форма предоставления содержания несовершеннолетним детям определяются родителями самостоятельно.'),
            ('81', 'Размер алиментов на несовершеннолетних детей',
             'При отсутствии соглашения об уплате алиментов алименты на несовершеннолетних детей взыскиваются судом с их родителей ежемесячно в размере: на одного ребенка - одной четверти, на двух детей - одной трети, на трех и более детей - половины заработка родителя.'),
            ('87', 'Обязанности совершеннолетних детей по содержанию родителей',
             'Трудоспособные совершеннолетние дети обязаны содержать своих нетрудоспособных нуждающихся в помощи родителей и заботиться о них.'),
        ]
        
        for article_num, title, content in sk_articles:
            articles.append(('СК РФ', article_num, title, content, f'{base_url}_8982/', 'Семейный кодекс Российской Федерации'))
    
    elif code == 'ZPP':
        # Закон о защите прав потребителей - основные статьи
        zpp_articles = [
            ('4', 'Качество товара',
             'Продавец обязан передать потребителю товар, качество которого соответствует договору. При отсутствии в договоре условий о качестве товара продавец обязан передать потребителю товар, пригодный для целей, для которых товар такого рода обычно используется.'),
            ('7', 'Право потребителя на безопасность товара',
             'Потребитель имеет право на то, чтобы товар при обычных условиях его использования был безопасен для жизни, здоровья потребителя, окружающей среды, а также не причинял вред имуществу потребителя.'),
            ('10', 'Информация о товарах',
             'Изготовитель обязан своевременно предоставлять потребителю необходимую и достоверную информацию о товарах, обеспечивающую возможность их правильного выбора.'),
            ('18', 'Права потребителя при обнаружении в товаре недостатков',
             'Потребитель в случае обнаружения в товаре недостатков вправе: потребовать замены на товар этой же марки; потребовать замены на такой же товар другой марки; потребовать соразмерного уменьшения покупной цены; потребовать незамедлительного безвозмездного устранения недостатков; отказаться от исполнения договора и потребовать возврата уплаченной суммы.'),
            ('19', 'Замена товара ненадлежащего качества',
             'Потребитель вправе потребовать замены недоброкачественного товара на товар надлежащего качества. Требование о замене подлежит удовлетворению в течение семи дней, а при необходимости дополнительной проверки - в течение двадцати дней.'),
            ('20', 'Устранение недостатков товара',
             'Если срок устранения недостатков товара не определен в письменной форме соглашением сторон, эти недостатки должны быть устранены изготовителем незамедлительно, то есть в минимальный срок, объективно необходимый для их устранения.'),
            ('21', 'Замена товара ненадлежащего качества на товар аналогичной марки',
             'В случае обнаружения потребителем недостатков товара и предъявления требования о его замене продавец обязан заменить такой товар в течение семи дней со дня предъявления требования, а при необходимости проверки качества - в течение двадцати дней.'),
            ('22', 'Сроки удовлетворения отдельных требований потребителя',
             'Требования потребителя о соразмерном уменьшении покупной цены товара, возмещении расходов на исправление недостатков потребителем или третьим лицом, возврате уплаченной за товар денежной суммы подлежат удовлетворению продавцом в течение десяти дней.'),
            ('23', 'Ответственность продавца за просрочку выполнения требований',
             'За нарушение предусмотренных сроков продавец уплачивает потребителю за каждый день просрочки неустойку (пеню) в размере одного процента цены товара.'),
            ('25', 'Право потребителя на обмен товара надлежащего качества',
             'Потребитель вправе обменять непродовольственный товар надлежащего качества на аналогичный товар у продавца, у которого этот товар был приобретен, если товар не подошел по форме, габаритам, фасону, расцветке, размеру или комплектации. Потребитель имеет право на обмен в течение четырнадцати дней, не считая дня покупки.'),
            ('27', 'Сроки удовлетворения требований потребителя',
             'Договор о выполнении работы или об оказании услуги может быть расторгнут в любое время по инициативе потребителя при условии оплаты исполнителю фактически понесенных им расходов.'),
            ('28', 'Последствия нарушения исполнителем сроков выполнения работы',
             'За нарушение сроков выполнения работы исполнитель уплачивает потребителю за каждый день просрочки неустойку в размере трех процентов цены выполнения работы.'),
            ('29', 'Права потребителя при обнаружении недостатков в работе',
             'Потребитель при обнаружении недостатков выполненной работы вправе потребовать: безвозмездного устранения недостатков; соответствующего уменьшения цены; безвозмездного изготовления другой вещи; возмещения понесенных расходов по устранению недостатков.'),
            ('31', 'Право потребителя на отказ от исполнения договора',
             'Потребитель вправе отказаться от исполнения договора о выполнении работы в любое время при условии оплаты исполнителю фактически понесенных им расходов, связанных с исполнением обязательств по договору.'),
            ('32', 'Право потребителя на отказ от договора',
             'Потребитель вправе отказаться от исполнения договора об оказании услуг в любое время при условии оплаты исполнителю фактически понесенных им расходов.'),
        ]
        
        for article_num, title, content in zpp_articles:
            articles.append(('ЗОЗПП', article_num, title, content, 'http://www.consultant.ru/document/cons_doc_LAW_305/', 'Закон о защите прав потребителей'))
    
    return articles