-- Создаем таблицу для статей земельного и гражданского кодексов РФ
CREATE TABLE IF NOT EXISTS law_articles (
    id SERIAL PRIMARY KEY,
    code_type VARCHAR(50) NOT NULL,
    article_number VARCHAR(20) NOT NULL,
    title TEXT NOT NULL,
    content TEXT NOT NULL,
    keywords TEXT[],
    chapter VARCHAR(100),
    section VARCHAR(100),
    url TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX IF NOT EXISTS idx_law_articles_code_type ON law_articles(code_type);
CREATE INDEX IF NOT EXISTS idx_law_articles_article_number ON law_articles(article_number);
CREATE INDEX IF NOT EXISTS idx_law_articles_keywords ON law_articles USING GIN(keywords);

CREATE TABLE IF NOT EXISTS land_consultations (
    id SERIAL PRIMARY KEY,
    question TEXT NOT NULL,
    answer TEXT NOT NULL,
    sources JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    user_ip VARCHAR(45),
    request_id VARCHAR(255)
);

CREATE INDEX IF NOT EXISTS idx_land_consultations_created_at ON land_consultations(created_at DESC);

INSERT INTO law_articles (code_type, article_number, title, content, keywords, chapter, section, url) VALUES
('ZK_RF', '1', 'Основные принципы земельного законодательства', 'Земельное законодательство основывается на следующих принципах: 1) учет значения земли как основы жизни и деятельности человека; 2) приоритет охраны земли как важнейшего компонента окружающей среды; 3) приоритет охраны жизни и здоровья человека; 4) участие граждан в решении вопросов землепользования; 5) единство судьбы земельных участков и прочно связанных с ними объектов; 6) приоритет сохранения особо ценных земель; 7) платность использования земли; 8) деление земель по целевому назначению; 9) разграничение государственной собственности на землю.', ARRAY['принципы', 'основы', 'законодательство', 'охрана земли', 'платность'], 'Глава I', 'Общие положения', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '7', 'Состав земель в Российской Федерации', 'Земли в Российской Федерации по целевому назначению подразделяются на следующие категории: 1) земли сельскохозяйственного назначения; 2) земли населенных пунктов; 3) земли промышленности, энергетики, транспорта, связи, радиовещания, телевидения, информатики, земли для обеспечения космической деятельности, земли обороны, безопасности и земли иного специального назначения; 4) земли особо охраняемых территорий и объектов; 5) земли лесного фонда; 6) земли водного фонда; 7) земли запаса.', ARRAY['категории земель', 'целевое назначение', 'сельхоз', 'населенные пункты', 'лесной фонд'], 'Глава II', 'Охрана земель', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '11', 'Разграничение государственной собственности на землю', 'Разграничение государственной собственности на землю на собственность Российской Федерации (федеральную собственность), собственность субъектов Российской Федерации и собственность муниципальных образований (муниципальную собственность) осуществляется в соответствии с настоящим Кодексом и федеральными законами.', ARRAY['государственная собственность', 'федеральная собственность', 'муниципальная собственность', 'разграничение'], 'Глава III', 'Собственность на землю', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '15', 'Собственность на землю граждан и юридических лиц', 'Гражданам и юридическим лицам земельные участки на праве собственности могут предоставляться в случаях и в порядке, которые предусмотрены настоящим Кодексом, федеральными законами. Иностранные граждане, лица без гражданства и иностранные юридические лица не могут обладать на праве собственности земельными участками, находящимися на приграничных территориях, перечень которых устанавливается Президентом РФ, и на иных установленных особо территориях РФ.', ARRAY['собственность', 'граждане', 'юридические лица', 'иностранцы', 'приграничные территории'], 'Глава III', 'Собственность на землю', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '22', 'Аренда земельных участков', 'Иностранные граждане, лица без гражданства, а также иностранные юридические лица могут иметь земельные участки на праве аренды, за исключением случаев, предусмотренных настоящим Кодексом. Земельные участки, находящиеся в государственной или муниципальной собственности, предоставляются в аренду в случаях и в порядке, которые предусмотрены настоящим Кодексом, федеральными законами.', ARRAY['аренда', 'договор аренды', 'срок аренды', 'арендная плата', 'государственная собственность'], 'Глава V', 'Возникновение прав на землю', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '25', 'Основания возникновения прав на землю', 'Права на земельные участки, предусмотренные главами III и IV настоящего Кодекса, возникают по основаниям, установленным гражданским законодательством, федеральными законами. Права на земельные участки возникают с момента государственной регистрации прав.', ARRAY['возникновение прав', 'основания прав', 'регистрация', 'оформление'], 'Глава V', 'Возникновение прав на землю', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '35', 'Постоянное (бессрочное) пользование земельными участками', 'В постоянное (бессрочное) пользование земельные участки предоставляются государственным и муниципальным учреждениям, казенным предприятиям, центрам исторического наследия президентов РФ, прекративших исполнение своих полномочий, а также органам государственной власти и органам местного самоуправления. Гражданам земельные участки в постоянное (бессрочное) пользование не предоставляются.', ARRAY['бессрочное пользование', 'постоянное пользование', 'государственные учреждения', 'казенные предприятия'], 'Глава V', 'Возникновение прав на землю', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '36', 'Безвозмездное срочное пользование земельными участками', 'В безвозмездное срочное пользование могут предоставляться земельные участки из земель, находящихся в государственной или муниципальной собственности, органам государственной власти, органам местного самоуправления, учреждениям, казенным предприятиям, центрам исторического наследия и другим.', ARRAY['безвозмездное пользование', 'срочное пользование', 'государственные земли'], 'Глава V', 'Возникновение прав на землю', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '39', 'Особенности купли-продажи земельных участков', 'Продажа земельных участков, находящихся в государственной или муниципальной собственности, осуществляется на торгах, проводимых в форме аукционов, за исключением случаев, установленных пунктом 2 настоящей статьи. Без проведения торгов могут продаваться земельные участки, предоставленные для ведения личного подсобного хозяйства, садоводства, огородничества, индивидуального жилищного строительства.', ARRAY['купля-продажа', 'торги', 'аукцион', 'продажа земли', 'ИЖС', 'садоводство'], 'Глава V', 'Возникновение прав на землю', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '39.1', 'Предоставление земельных участков без торгов', 'Без проведения торгов осуществляется продажа земельных участков или предоставление их в аренду в случаях, если: 1) земельный участок предоставлен для ИЖС, ведения личного подсобного хозяйства, садоводства, огородничества; 2) на земельном участке расположены здания, сооружения, принадлежащие гражданину или юридическому лицу.', ARRAY['без торгов', 'продажа земли', 'ИЖС', 'ЛПХ', 'исключения из торгов'], 'Глава V', 'Возникновение прав на землю', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '49', 'Изъятие земельных участков для государственных или муниципальных нужд', 'Изъятие земельных участков для государственных или муниципальных нужд осуществляется в исключительных случаях, связанных с размещением объектов государственного или муниципального значения при отсутствии других вариантов размещения этих объектов. Решение об изъятии принимается федеральными органами, органами субъекта РФ или местного самоуправления.', ARRAY['изъятие земли', 'государственные нужды', 'выкуп', 'принудительное изъятие', 'компенсация'], 'Глава VII', 'Прекращение и ограничение прав на землю', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '60', 'Права на земельные участки лиц, не являющихся собственниками земельных участков', 'Лица, не являющиеся собственниками земельных участков, могут обладать следующими правами на земельные участки: 1) право пожизненного наследуемого владения; 2) право постоянного (бессрочного) пользования; 3) право безвозмездного срочного пользования; 4) сервитут, публичный сервитут; 5) аренда.', ARRAY['права на землю', 'пожизненное владение', 'пользование', 'сервитут', 'аренда'], 'Глава V', 'Возникновение прав на землю', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '64', 'Права и обязанности собственников земельных участков', 'Собственник земельного участка имеет право возводить жилые, производственные, культурно-бытовые и иные здания, строения, сооружения, осуществлять их перестройку или снос, разрешать строительство на своем участке другим лицам. Собственник земельного участка обязан использовать участок в соответствии с его целевым назначением, не наносить вред окружающей среде, соблюдать при использовании земельных участков требования градостроительных регламентов.', ARRAY['права собственника', 'обязанности собственника', 'строительство', 'целевое использование'], 'Глава VIII', 'Права и обязанности', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '65', 'Права и обязанности лиц, не являющихся собственниками', 'Лица, не являющиеся собственниками земельных участков, за исключением обладателей сервитутов, осуществляют права собственников земельных участков, установленные статьей 40 настоящего Кодекса, за исключением прав, установленных подпунктом 2 пункта 1 статьи 40 настоящего Кодекса.', ARRAY['права арендаторов', 'права пользователей', 'обязанности арендаторов'], 'Глава VIII', 'Права и обязанности', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '77', 'Особенности земель сельскохозяйственного назначения', 'Землями сельскохозяйственного назначения признаются земли, находящиеся за границами населенного пункта и предоставленные для нужд сельского хозяйства, а также предназначенные для этих целей. В составе земель сельскохозяйственного назначения выделяются сельскохозяйственные угодья, земли, занятые внутрихозяйственными дорогами, коммуникациями, лесными насаждениями и другие земли.', ARRAY['сельхоз земли', 'сельское хозяйство', 'сельхозугодья', 'КФХ', 'фермерство'], 'Глава XIV', 'Земли сельскохозяйственного назначения', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '78', 'Использование земель сельскохозяйственного назначения', 'Земли сельскохозяйственного назначения могут использоваться для ведения сельскохозяйственного производства, создания защитных лесных насаждений, научно-исследовательских, учебных и иных связанных с сельскохозяйственным производством целей. Крестьянским (фермерским) хозяйствам, сельскохозяйственным организациям, гражданам, ведущим личное подсобное хозяйство, садоводство, огородничество и животноводство.', ARRAY['использование земли', 'сельхозпроизводство', 'КФХ', 'ЛПХ', 'садоводство'], 'Глава XIV', 'Земли сельскохозяйственного назначения', 'http://www.consultant.ru/document/cons_doc_LAW_33773/'),

('ZK_RF', '85', 'Земли населенных пунктов и их состав', 'Землями населенных пунктов признаются земли, используемые и предназначенные для застройки и развития населенных пунктов. Границы городских, сельских населенных пунктов отделяют земли населенных пунктов от земель иных категорий. В состав земель населенных пунктов могут входить земельные участки: жилых зон, общественно-деловых зон, производственных зон, зон инженерных и транспортных инфраструктур, рекреационных зон, зон сельскохозяйственного использования.', ARRAY['населенные пункты', 'застройка', 'ИЖС', 'жилая зона', 'градостроительство'], 'Глава XV', 'Земли населенных пунктов', 'http://www.consultant.ru/document/cons_doc_LAW_33773/');

INSERT INTO law_articles (code_type, article_number, title, content, keywords, chapter, section, url) VALUES
('GK_RF', '130', 'Недвижимые и движимые вещи', 'К недвижимым вещам (недвижимое имущество, недвижимость) относятся земельные участки, участки недр и все, что прочно связано с землей, то есть объекты, перемещение которых без несоразмерного ущерба их назначению невозможно, в том числе здания, сооружения, объекты незавершенного строительства. К недвижимым вещам относятся также подлежащие государственной регистрации воздушные и морские суда, суда внутреннего плавания.', ARRAY['недвижимость', 'земельные участки', 'здания', 'регистрация права', 'объекты'], 'Глава 6', 'Общие положения', 'http://www.consultant.ru/document/cons_doc_LAW_5142/'),

('GK_RF', '131', 'Государственная регистрация недвижимости', 'Право собственности и другие вещные права на недвижимые вещи, ограничения этих прав, их возникновение, переход и прекращение подлежат государственной регистрации в едином государственном реестре органами, осуществляющими государственную регистрацию прав на недвижимость и сделок с ней. Регистрации подлежат: право собственности, право хозяйственного ведения, право оперативного управления, право пожизненного наследуемого владения, право постоянного пользования, ипотека, сервитуты, а также иные права в случаях, предусмотренных настоящим Кодексом и иными законами.', ARRAY['регистрация', 'Росреестр', 'право собственности', 'ЕГРН', 'кадастр'], 'Глава 6', 'Общие положения', 'http://www.consultant.ru/document/cons_doc_LAW_5142/'),

('GK_RF', '209', 'Содержание права собственности', 'Собственнику принадлежат права владения, пользования и распоряжения своим имуществом. Собственник вправе по своему усмотрению совершать в отношении принадлежащего ему имущества любые действия, не противоречащие закону и иным правовым актам и не нарушающие права и охраняемые законом интересы других лиц, в том числе отчуждать свое имущество в собственность другим лицам, передавать им, оставаясь собственником, права владения, пользования и распоряжения имуществом.', ARRAY['право собственности', 'владение', 'пользование', 'распоряжение', 'права собственника'], 'Глава 13', 'Общие положения', 'http://www.consultant.ru/document/cons_doc_LAW_5142/'),

('GK_RF', '250', 'Преимущественное право покупки', 'При продаже доли в праве общей собственности постороннему лицу остальные участники долевой собственности имеют преимущественное право покупки продаваемой доли по цене, за которую она продается, и на прочих равных условиях, кроме случая продажи с публичных торгов. Продавец доли обязан известить в письменной форме остальных участников долевой собственности о намерении продать свою долю постороннему лицу с указанием цены и других условий, на которых продает ее.', ARRAY['преимущественное право', 'покупка доли', 'долевая собственность', 'продажа доли'], 'Глава 16', 'Общая собственность', 'http://www.consultant.ru/document/cons_doc_LAW_5142/'),

('GK_RF', '551', 'Государственная регистрация перехода права собственности', 'Переход права собственности на недвижимость по договору продажи недвижимости к покупателю подлежит государственной регистрации. Исполнение договора продажи недвижимости сторонами до государственной регистрации перехода права собственности не является основанием для изменения их отношений с третьими лицами.', ARRAY['переход права', 'купля-продажа', 'регистрация сделки', 'покупка недвижимости'], 'Глава 30', 'Купля-продажа', 'http://www.consultant.ru/document/cons_doc_LAW_5142/'),

('GK_RF', '606', 'Договор аренды', 'По договору аренды (имущественного найма) арендодатель (наймодатель) обязуется предоставить арендатору (нанимателю) имущество за плату во временное владение и пользование или во временное пользование. Плоды, продукция и доходы, полученные арендатором в результате использования арендованного имущества, являются его собственностью.', ARRAY['договор аренды', 'арендодатель', 'арендатор', 'арендная плата', 'наём'], 'Глава 34', 'Аренда', 'http://www.consultant.ru/document/cons_doc_LAW_5142/'),

('GK_RF', '617', 'Форма и государственная регистрация договора аренды', 'Договор аренды недвижимого имущества подлежит государственной регистрации, если иное не установлено законом. Договор аренды недвижимого имущества заключается в письменной форме путем составления одного документа, подписанного сторонами. Несоблюдение формы договора аренды недвижимого имущества влечет его недействительность.', ARRAY['договор аренды недвижимости', 'регистрация договора', 'форма договора', 'недействительность'], 'Глава 34', 'Аренда', 'http://www.consultant.ru/document/cons_doc_LAW_5142/'),

('GK_RF', '1181', 'Наследование земельных участков', 'Принадлежавшие наследодателю на праве собственности земельный участок или право пожизненного наследуемого владения земельным участком входит в состав наследства и наследуется на общих основаниях. На принятие наследства, в состав которого входит указанное имущество, специальное разрешение не требуется.', ARRAY['наследование', 'наследство', 'земельный участок', 'наследники', 'завещание'], 'Глава 65', 'Наследование отдельных видов имущества', 'http://www.consultant.ru/document/cons_doc_LAW_5142/');